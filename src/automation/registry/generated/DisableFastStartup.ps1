#!ignore WARNING! This script is auto-generated by Generate.ps1 from the definition .\DisableFastStartup.json, do not edit manually.
<#
.SYNOPSIS
	Disables Windows Fast Boot, also known as Hiberboot or Fast Startup.

.DESCRIPTION
	In this day and age, realistically Fast Boot causes more issues than it solves, the time saving is less than a matter of seconds.
	Disabling Fast Boot will keep the system healthier and more reliable in day to day use.

.OUTPUT
	None
#>

using module ..\..\..\..\src\common\Registry.psm1
using module ..\..\..\..\src\common\Environment.psm1
using module ..\..\..\..\src\common\Ensure.psm1
using module ..\..\..\..\src\common\Logging.psm1

[CmdletBinding()]
param()

Invoke-RunMain $PSCmdlet {
    Invoke-EnsureAdministrator;

    $Value = 0;
    $Type = "DWord";
    $Path = "HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power";
    $Key = "HiberbootEnabled";
    $CurrentValue = Get-RegistryKey -Path $Path -Key $Key -ErrorAction SilentlyContinue;
    if (-not ($CurrentValue -eq 0)) {
        Invoke-Info "Changing registry value: Path=$Path, Key=$Key, From=$CurrentValue, To=$Value"
        Set-RegistryKey -Path $Path -Key $Key -Value $Value -Kind $Type
    } else {
        Invoke-Info "Registry value already set correctly: Path=$Path, Key=$Key, Value=$Value"
    }

}

